<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Opowieści</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .passage { background: #f5f5f5; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .choices { margin-top: 20px; }
        .choice { display: block; margin: 10px 0; padding: 10px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .choice:hover { background: #0056b3; }
    </style>
</head>
<body>
    <div id="story-container">
        <h1>Test Opowieści</h1>
        <div id="current-passage"></div>
    </div>

    <script>
        class StoryPlayer {
            constructor() {
                this.currentPassageId = 1;
                this.variables = {};
                this.loadStory();
            }

            loadStory() {
                const storyData = localStorage.getItem('storyTestData');
                if (storyData) {
                    const data = JSON.parse(storyData);
                    this.passages = data.passages;
                    this.variables = data.variables;
                    this.showPassage(this.currentPassageId);
                } else {
                    document.getElementById('current-passage').innerHTML = '<p>Brak danych opowieści. Wróć do edytora i uruchom test ponownie.</p>';
                }
            }

            showPassage(passageId) {
                const passage = this.passages.find(p => p.id === passageId);
                if (!passage) {
                    document.getElementById('current-passage').innerHTML = '<p>Scena nie znaleziona!</p>';
                    return;
                }

                let content = `<div class="passage"><h2>${passage.title}</h2><p>${passage.content}</p>`;
                
                if (passage.choices && passage.choices.length > 0) {
                    content += '<div class="choices">';
                    passage.choices.forEach(choice => {
                        if (choice.text && choice.target) {
                            content += `<button class="choice" onclick="storyPlayer.showPassage(${choice.target})">${choice.text}</button>`;
                        }
                    });
                    content += '</div>';
                }
                
                content += '</div>';
                document.getElementById('current-passage').innerHTML = content;
            }
        }

        const storyPlayer = new StoryPlayer();
    </script>
</body>
</html>